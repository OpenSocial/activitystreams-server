/*! activitystreams 2014-04-17 Copyright (c) 2013 International Business Machines & OpenSocial Foundation, Apache Software License v2.0 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a):b():b(a)}("undefined"!=typeof window?window:this,function(a){function b(a,b,c){return Math.min(Math.max(a,c),b)}function c(a,b){return void 0===a||null===a?!1:C&&a.indexOf===C?a.indexOf(b)>-1:"object"==typeof a?b in a:!1}function d(){return new Error("Invalid Type")}function e(a,b,c){if(void 0===a||null===a)return a;if(B&&a.forEach===B)a.forEach(b,c);else for(var d in a)b.call(c,a[d],d,a)}function f(a,b){void 0!==a&&"object"==typeof a&&(z(a),e(x(a),function(d){c(b,d)||f(a[d])}))}function g(a,b){if(void 0===a||null===a)return a;switch(typeof b){case"string":if(typeof a===b)return a;break;case"object":if(A(b))for(var c in b)if(typeof a===b[c])return a;break;case"function":if(a instanceof b)return a}throw d()}function h(){if(1==arguments.length){var a=arguments[0];if(void 0===a||null===a)return;if(isNaN(+a))throw d()}else e(arguments,function(a){h(a)})}function i(a,b){var c=x(b);for(var d in c)d in D&&x[d]===D[d]||d in E&&x[d]===E[d]||(a[x[d]]=b[c[d]]);return a}function j(a,b,c){if(void 0===b||void 0===b)return a;var d=[].concat(a);return b=A(b)?b:[b],e(b,function(){var a=+b.__type__;3>a?d.push(b):3==a&&(d=d.concat(b))}),y(d,"__type__",n(3)),y(d,"__rel__",n(c)),z(d),d}function k(a,b){a.__model__=a.__model__||b,e(b,function(c,d){try{a.__model__!==b&&(a.__model__[d]=c),y(a,d,c)}catch(e){}})}function l(a){return this instanceof l?void("object"!=typeof a||A(a)||i(this,a)):new l(a)}function m(a,b,c,d,e){y(a,b,{get:function(){return t(c,d,e)}})}function n(a,b){var c={enumerable:!1,configurable:!1};return void 0===a?c.writable=!1:b?b&&(c.get=a):c.value=a,c}function o(a){if(A(a))throw d();return a}function p(a,b,c,d){if(k(a,b),!d&&void 0!==a.objectType&&a.objectType.id in G.forObjectType){var e=G.forObjectType[a.objectType.id];e!==b&&e!==c&&k(a,e)}void 0!==c&&k(a,c)}function q(a,b,c,d){y(a,b,{enumerable:!0,configurable:!1,get:function(){return I.Transforms.toLink(c,d,b,G.ActionHandler)}})}function r(a,b){if(void 0===a||null===a)return void 0;if(o(a),void 0===a.__wrapped__){for(var c in a){var d=a[c];q(a,c,d,b)}y(a,"__wrapped__",n(!0))}return a}function s(a,b){if(void 0===a||null===a)return void 0;if(a.__wrapped__)return a;var c,e=b.language||F||"en";if(-1!=e.indexOf("*"))throw new Error("Default language context cannot be a wildcard");switch(typeof a){case"string":c={},c[e]=a;break;case"object":c=a;break;default:throw d()}return y(c,"__wrapped__",n(!0)),y(c,"*",n(function(){return c[e]},!0)),y(c,"toString",n(function(){return c[e]},!1)),c}function t(a,b,c,e){if(g(a,["string","object"]),a.__wrapped__)return a;var f={__wrapped__:a,__context__:b,__rel__:c},h=G.SimpleLinkValue;switch(typeof a){case"string":h=G.SimpleLinkValue,f.__type__=I.Constants.__simple__;break;case"object":o(a),h=G.Object,f.__type__=I.Constants.__object__;break;default:throw d()}return p(f,h,e),z(f),f}function u(a,b,c,e){if(!e&&(void 0===a||null===a))return void 0;if(a&&a.__wrapped__)return a;g(a,["string","object"]),o(a),"string"==typeof a&&(a=I.typeValueResolver(a));var f={__wrapped__:a,__context__:b},h=G.SimpleTypeValue;switch(typeof a){case"object":f.__type__=I.Constants.__object__,h=G.Object;break;case"string":f.__type__=I.Constants.__simple__;break;case"undefined":f.__type__=I.Constants.__anonymous__;break;default:throw d()}return p(f,h,c),z(f),f}function v(a,b,c,d){if(void 0===a||null===a)return void 0;if(a.__wrapped__)return a;g(a,"object"),o(a),c=c||G.Object;var e={__wrapped__:a,__context__:b};return p(e,c,d),z(e),e}function w(a){return a}var x=Object.getOwnPropertyNames,y=Object.defineProperty,z=Object.freeze,A=Array.isArray,B=Array.prototype.forEach,C=Array.prototype.indexOf,D=Object.prototype,E=Array.prototype,F=function(a){return"undefined"!=typeof navigator&&navigator.language?navigator.language:a}("en");"undefined"==typeof A&&(A=function(a){return"[object Array]"==Object.prototype.toString.call(a)}),"undefined"==typeof z&&(z=function(){}),l.prototype={extend:function(a){return i(Object.create(this),a||{})},hidden:function(a,b,c){return this[a]=n(b,c),this},property:function(a,b,c){return this[c||a]=G.property(b||a),this},link:function(a,b){return this[b||a]=G.link(a),this},boundNumber:function(a,b,c,d,e,f){return this[f||a]=G.boundNumber(a,b,c,d,e),this},number:function(a,b,c){return this[c||a]=G.number(a,b),this},nonNegativeNumber:function(a,b){return this[b||a]=G.nonNegativeNumber(a),this},nlv:function(a,b){return this[b||a]=G.nlv(a),this},type:function(a,b,c){return this[c||a]=G.type(a,b),this},collection:function(a,b){return this[b||a]=G.collection(a),this},dateTime:function(a,b){return this[b||a]=G.dateTime(a),this},bool:function(a,b,c){return this[b||a]=G.boolean(a,c),this},parameters:function(a,b){return this[b||a]=G.parameters(a),this},genericObject:function(a,b,c){return this[c||a]=G.genericObject(a,b),this},toString:function(){var a=[];for(var b in this)this[b]!==l.prototype[b]&&"function"!=typeof[b]&&this[b].enumerable&&a.push(b);return"Model: "+a.join(", ")}},z(l.prototype);var G={property:function(a){if("function"!=typeof a){var b=a;a=function(){return this.__wrapped__[b]}}return{enumerable:!0,configurable:!1,get:a}},"boolean":function(a,b){return G.property(function(){return"object"==typeof this.__wrapped__&&a in this.__wrapped__?Boolean(this.__wrapped__[a]):"boolean"==typeof b?b:!1})},link:function(a){return G.property(function(){return I.Transforms.toLink(this.__wrapped__[a],this,a)})},boundNumber:function(a,c,d,e,f){return h(e,c,d),G.property(function(){var g=this.__wrapped__[a]||e;return h(g),void 0!==g&&null!==g&&(g=b(g,d,c),void 0!==f&&g.toFixed&&(g=g.toFixed(f))),g})},nonNegativeNumber:function(a){return G.property(function(){var b=this.__wrapped__[a];return void 0!==b&&null!==b&&(h(b),b=Math.max(0,b)),b})},number:function(a,b){return G.property(function(){var c=this.__wrapped__[a];return void 0!==c&&null!==c&&(h(c),c=void 0!==b&&c.toFixed?c.toFixed(b):c),c})},nlv:function(a){return G.property(function(){return s(this.__wrapped__[a],this)})},type:function(a,b){return G.property(function(){return u(this.__wrapped__[a],this,void 0,b)})},collection:function(a){return G.property(function(){return v(this.__wrapped__[a],this,G.Collection)})},dateTime:function(a){return G.property(function(){var b=this.__wrapped__[a];return void 0!==a&&null!==a&&(b=I.Transforms.toDateTime(this.__wrapped__[a])),b})},parameters:function(a){return G.property(function(){function b(a,b,c,d){y(a,b,{enumerable:!0,configurable:!1,get:function(){return u(c,d)}})}var c=this.__wrapped__[a];if(void 0===c||null===c)return void 0;if(g(c,["object"]),o(c),!c.__wrapped__){for(var d in c)b(c,d,c[d],this);y(c,"__wrapped__",n(!0))}return c})},genericObject:function(a,b){return G.property(function(){return v(this.__wrapped__[a],this,b)})}};G.Base=new l({__wrapped__:n(),__context__:n(),__model__:n(),__asActivity:n(function(){return v(this.__wrapped__,this.__context__,G.Activity,this.__model__)},!0),__asCollection:n(function(){return v(this.__wrapped__,this.__context__,G.Collection,this.__model__)},!0),__asObject:n(function(){return v(this.__wrapped__,this.__context__,this.__model__)},!0),extended:n(function(){var a=this;return function(b){return void 0!==a.__rel__?t(a.__wrapped__,a.__context__,a.__rel__,b):new(Object.getPrototypeOf(a).constructor)(a.__wrapped__,a.__context__,b)}},!0),get:n(function(){var a=this.__wrapped__;return function(b,c){var d=a[b];return void 0!==c&&("function"==typeof c?void 0!==d&&(d=c(d,this,b)):(void 0===d||null===d)&&(d=c)),d}},!0),has:n(function(){var a=this.__wrapped__;return function(b){return b in a}},!0),toString:n(function(){return JSON.stringify(this.__wrapped__)},!0)}),G.TypeValue=G.Base.extend().hidden("__type__").hidden("__anonymous__",function(){return!this.id},!0),G.SimpleTypeValue=G.TypeValue.extend().property("id",function(){return this.__wrapped__}),G.Object=G.Base.extend().property("id",function(){return this.__wrapped__.id||this.__wrapped__["@id"]}).property("objectType",function(){var a=this.__wrapped__.objectType||this.__wrapped__["@type"];return u(a,this,void 0,!0)}).property("@type",function(){return this.__wrapped__["@type"]||this.objectType}).property("@id",function(){return this.__wrapped__["@id"]||this.id}).property("@language",function(){return this.__wrapped__["@language"]||this.language}).property("@value").property("@context").property("language",function(){var a=this.__wrapped__.language||this.__wrapped__["@language"];return a||(this.__context__?this.__context__.language:F)||"en"}).property("rel",function(){return this.__wrapped__.rel||this.__rel__}).property("mediaType").property("alias").property("duplicates",function(){var a;return a="duplicates"in this.__wrapped__?t(this.__wrapped__.duplicates,this):I.Transforms.toLink([]),a=j(a,[this.downstreamDuplicates,this.upstreamDuplicates],"duplicates")}).nlv("displayName").nlv("summary").nlv("title").nlv("content").link("url").link("attachments").link("author").link("downstreamDuplicates").link("upstreamDuplicates").link("icon").link("image").link("location").link("generator").link("provider").link("tags").link("inReplyTo").link("scope").dateTime("published").dateTime("updated").dateTime("startTime").dateTime("endTime").boundNumber("rating",0,5,0).property("duration").nonNegativeNumber("height").nonNegativeNumber("width").collection("replies").property("actions",function(){return r(this.__wrapped__.actions,this)}).hidden("isA",function(a){function b(a,b){for(var c in b)if(void 0!==b[c]&&b[c].id==a)return!0;return!1}function c(a){for(var b in a)if(void 0!==a[b]&&!a[b].__anonymous__)return!1;return!0}switch(typeof a){case"string":return b(a,[this.objectType,this.verb]);case"object":if(void 0!==a.objectType)switch(a.objectType.id||a.objectType){case"verb":return b(a.id,[this.verb]);case"objectType":return b(a.id,[this.objectType])}else if(void 0!==a.id)return b(a.id,[this.objectType,this.verb]);break;case"undefined":return c([this.objectType,this.verb])}return!1}),G.Activity=G.Object.extend().type("verb",!1).link("actor").link("object").link("target").link("result").link("instrument").link("participant").link("to").link("bto").link("cc").link("bcc").link("from").link("bfrom").property("status",function(){var a=this.__wrapped__.status;return void 0!==a&&I.Constants.status.indexOf(a)>-1?a:"other"}).boundNumber("priority",0,1,0),G.LinkValue=G.Base.extend().hidden("__type__").hidden("__rel__"),G.SimpleLinkValue=G.Base.extend().property("href",function(){return this.__wrapped__}).property("rel",function(){return this.__rel__}),G.Collection=G.Object.extend().nonNegativeNumber("totalItems").property("items",function(){var a=this.__wrapped__.items;if(void 0!==a&&null!==a){if(!A(a))throw d();var b=this;a=a.map(function(a){return v(a,b)})}return a}).dateTime("itemsAfter").dateTime("itemsBefore").nonNegativeNumber("itemsPerPage").nonNegativeNumber("startIndex").link("first").link("last").link("prev").link("next").link("current").link("self"),G.ActionHandler=G.Object.extend().property("context","context").property("auth","auth").bool("confirm").link("expects").link("returns").link("requires").link("prefers"),G.HttpActionHandler=G.ActionHandler.extend().property("method").property("target"),G.EmbedActionHandler=G.ActionHandler.extend().property("style").property("target").link("preview"),G.IntentActionHandler=G.ActionHandler.extend(),G.Parameter=G.Object.extend().bool("required",!0).bool("repeated",!1).property("value").property("default").property("enum").property("maximum").property("minumum").property("format").property("pattern").nonNegativeNumber("step").nlv("placeholder"),G.UrlTemplate=G.Object.extend().property("template").parameters("parameters","params"),G.TypedPayload=G.Object.extend().type("type",!1,"semanticType").link("schema"),G.HtmlForm=G.Object.extend().parameters("parameters","params"),G.Ext={},G.Ext.Replies=new l({}).collection("attending").collection("followers").collection("following").collection("friends").collection("friend-requests","friendRequests").collection("likes").collection("notAttending").collection("maybeAttending").collection("reviews").collection("saves").collection("saves").collection("shares"),G.Ext.Position=G.Base.extend().number("altitude",2).boundNumber("latitude",-90,90,void 0,2).boundNumber("longitude",-180,180,void 0,2),G.Ext.Address=G.Base.extend().property("formated").property("streetAddress").property("locality").property("region").property("postalCode").property("country"),G.Ext.Place=G.Base.extend().genericObject("position",G.Ext.Position).genericObject("address",G.Ext.Address),G.Ext.Mood=G.Base.extend().type("mood",!1),G.forObjectType={activity:G.Activity,collection:G.Collection,verb:G.Object,objectType:G.Object,HttpActionHandler:G.HttpActionHandler,EmbedActionHandler:G.EmbedActionHandler,IntentActionHandler:G.IntentActionHandler,HtmlForm:G.HtmlForm,UrlTemplate:G.UrlTemplate,typedPayload:G.TypedPayload,parameter:G.Parameter,place:G.Ext.Place,address:G.Ext.Address,position:G.Ext.Position,mood:G.Ext.Mood};var H=w,I={get typeValueResolver(){return function(a){try{var b=H(a)||a;return g(b,["object","string"]),b}catch(c){return a}}},set typeValueResolver(a){"function"==typeof a&&(H=a)},indexTypeValuesFromCollection:function(a){var b={},d=["verb","objectType"],f=a.items;return A(f)&&e(f,function(a){c(d,a.objectType.id)&&a.id&&(b[a.id]=a.__wrapped__)}),b},parse:function(a){var b=JSON.parse(a);return"verb"in b?v(b,void 0,G.Activity):"items"in b?v(b,void 0,G.Collection):v(b)},Object:v,Collection:function(a){return v(a,void 0,G.Collection)},Activity:function(a){return v(a,void 0,G.Activity)},Transforms:{toLink:function(a,b,c,d){if(void 0===a)return void 0;if(A(a)){if(void 0===a.__type__){for(var e in a)m(a,e,a[e],this,c);a.__type__=I.Constants.__array__,a.__rel__=c,y(a,"__type__",n()),y(a,"__rel__",n()),z(a)}return a}return t(a,b,c,d)},toType:function(a,b,c){return u(a,b,void 0,c)},toNaturalLanguageValue:function(a,b){return s(a,b)},toCollection:function(a,b){return v(a,b,G.Collection)},toObject:function(a,b){return v(a,b)},toActivity:function(a,b){return v(a,b,G.Activity)},toDateTime:function(a){var b;if(a instanceof Date)b=a;else{if("string"!=typeof a)throw d();b=new Date(a)}return b}},Constants:{__anonymous__:"__anonymous__",__object__:2,__simple__:1,__type__:"__type__",__array__:3,post:"post",activity:"activity",verb:"verb",objectType:"objectType",collection:"collection",status:["active","canceled","completed","pending","tentative","voided"],formats:{"boolean":"boolean","byte":"byte",hex:"hex",date:"date","double":"double",duration:"duration","float":"float",int32:"int32",int64:"int64",uint32:"uint32",uint64:"uint64",lang:"lang",uri:"uri",iri:"iri"},verbs:{accept:"accept",access:"access",acknowledge:"acknowledge",add:"add",agree:"agree",append:"append",approve:"approve",archive:"archive",assign:"assign",at:"at",attach:"attach",attend:"attend",author:"author",authorize:"authorize",borrow:"borrow",build:"build",cancel:"cancel",close:"close",complete:"complete",confirm:"confirm",consume:"consume",checkin:"checkin",create:"create","delete":"delete",deliver:"deliver",deny:"deny",disagree:"disagree",dislike:"dislike",experience:"experience",favorite:"favorite",find:"find",flagAsInappropriate:"flag-as-inappropriate",follow:"follow",give:"give",host:"host",ignore:"ignore",insert:"insert",install:"install",interact:"interact",invite:"invite",join:"join",leave:"leave",like:"like",listen:"listen",lose:"lose",makeFriend:"make-friend",open:"open",play:"play",present:"present",purchase:"purchase",qualify:"qualify",read:"read",receive:"receive",reject:"reject",remove:"remove",removeFriend:"removeFriend",replace:"replace",request:"request",requestFriend:"requestFriend",resolve:"resolve",_return:"return",retract:"retract",rsvpMaybe:"rsvp-maybe",rsvpNo:"rsvp-no",rsvpYes:"rsvp-yes",satisfy:"satisfy",save:"save",schedule:"schedule",search:"search",sell:"sell",send:"send",share:"share",sponsor:"sponsor",start:"start",stopFollowing:"stop-following",submit:"submit",tag:"tag",terminate:"terminate",tie:"tie",unfavorite:"unfavorite",unlike:"unlike",unsatisfy:"unsatisfy",unsave:"unsave",unshare:"unshare",update:"update",use:"use",watch:"watch",win:"win"},objectTypes:{alert:"alert",application:"application",article:"article",audio:"audio",badge:"badge",binary:"binary",bookmark:"bookmark",collection:"collection",comment:"comment",device:"device",event:"event",file:"file",game:"game",group:"group",image:"image",issue:"issue",job:"job",note:"note",offer:"offer",organization:"organization",page:"page",permission:"permission",person:"person",place:"place",process:"process",product:"product",question:"question",review:"review",role:"role",service:"service",task:"task",team:"team",video:"video"}},Models:G};return f(I,["Models"]),"function"==typeof define&&define.amd&&define("asms",[],function(){return I}),void 0!==a&&(a.asms=I),I});